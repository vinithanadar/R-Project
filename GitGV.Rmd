---
title: "GitGV"
output: 
---
```{r}

library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
```

```{r}

library(rsconnect)
```

```{r}
library(janitor)

dig <- read.csv("DIG.csv") %>%
  janitor::clean_names()
dig
```

Age vs Sex comparsion:

```{r}
#Age vs sex Comparision

library(shiny)
library(shinydashboard)
library(ggplot2)
library(readr)
library(dplyr)
library(janitor)

dig <- read_csv("DIG.csv") %>%
  janitor::clean_names()

ui <- dashboardPage(
  dashboardHeader(title = "DIG COMPARISON"),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem("Age and Sex comparison", tabName = "comparison", icon = icon("users"))
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "comparison",
        fluidRow(
          box(width = 6, title = "Age distribution by sex",status = "primary",
              plotOutput("age_sex_plot")),
          
          box(width = 6 , title = "Summary table", status = "info",
              tableOutput("sex_age_summary"))
        )
      )
    )
  ) 
)

# --server--

server <- function(input,output,session) {
  
  output$age_sex_plot <- renderPlot({
    ggplot(dig, aes(x=age, fill = as.factor(sex))) +
      geom_histogram(alpha = 0.6 , bins = 30 , position = "identity") +
      labs(
        x = "Age",
        y = "Count",
        fill = "Sex",
        title = "Distribution of Age by sex"
      ) +
      theme_minimal()
  })
  
  output$sex_age_summary <- renderTable({
    dig %>%
      group_by(sex) %>%
      summarise(
        count = n(),
        mean_age = round(mean(age, na.rm = TRUE), 1),
        median_age = median(age, na.rm = TRUE),
        min_age = min(age, na.rm = TRUE),
        max_age = max(age, na.rm = TRUE)
      )
  })
}



shinyApp(ui, server )

```

Interpretation:

 I loaded the  DIG.csv data and made all the columns as lowercase and I built a shiny dashboard ui to display the age vs sex comparison and the server generate the histogram of age and sex and i also added the summary  table for min,max,median,mean for age per sex.Finally this code runs an shinyapp() which will show the plots and table summary.
 
 
 
 

Next question:



AGE VS DIABETES:
```{r}

library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)

dig <- read.csv("DIG.csv") %>%
  janitor::clean_names()


# --- mutating a another column for age categories(it will be better for pie chart)---

dig_mut1 <- dig %>%
  mutate(age_group =
           case_when(
             age < 50 ~ "Below 50"  ,
             age >= 50 & age < 70  ~ "50-69",
             age >= 70 ~ "70+" )
           )


ui <- dashboardPage(
  dashboardHeader(title = "AGE vs DIABETES - pie chart"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Age  and diabetes", tabName = "age_diabetes" , icon = icon("pie-chart"))
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "age_diabetes" , 
        
        fluidRow(
          box(
            width = 6,  status = "primary", title = "Pie chart : Age Group vs Diabetes" ,
            plotOutput("age_diabetes_pie")
            
          ),
          
          box( 
            width = 6 , status = "info" , title = "Summary Table" , 
            tableOutput("age_diabetes_table")
          ),
          
        )
      )
    )
  )
  
)

server <- function(input , output , session) {
  
  output$age_diabetes_pie <- renderPlot({
    
    pie_data <- dig_mut1 %>%
      group_by(age_group , diabetes) %>%
      summarise(count = n()) %>%
      ungroup()
    
    
    ggplot(pie_data, aes(x = "", y = count, fill = interaction(age_group, diabetes))) +
      geom_col(width = 1)+
      coord_polar("y", start = 0)+
      labs(
        fill = "Age Group + Diabetes",
        title = "Age Group vs Diabetes (Pie Chart)"
      ) +
      theme_void()
  
  })
 
  
  output$age_diabetes_table <- renderTable({
    dig_mut1 %>%
      group_by(age_group, diabetes) %>%
      summarise(
        count = n(),
        mean_age = round(mean(age),1 )
      )
  })
  
   
 }

shinyApp(ui,server)



```
Interpretation:

 I mutated a data frame called "dig_mut1" for better visualization diabetes age in pie chart and and I built a shiny dashboard code to represent the age and diabetes of the patient  and I created a server page  consisting of pie-chart visualization of the data and I made summary table for better understanding of age groups,so This code will show the age vs diabetes pie-chart visualization and a summary table ..
 
 
 Next question:
 
 Age vs Hypertension:
 
```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(janitor)

dig_mut1

ui <- dashboardPage(
  dashboardHeader(title = "Hypertension vs Age - Pie Chart"),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem("Age vs Hypertension(Pie Chart)", tabName = "hypertension_age", icon = icon("pie-chart"))
    )
  ),
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "hypertension_age",
        
        fluidRow(
          box(width = 6 , title = "hypertension ditribution from Age Group",
              status = "primary", plotOutput("pie_chart")) , 
          
          box(width = 6 , title = "Summary table",
              status = "info", tableOutput("pie_summary"))
          
        )
      )
    )
  )
  
)


server <- function(input , output, session) {
  
  output$pie_chart <- renderPlot({
    
    pie_data <- dig_mut1 %>%
      group_by(age_group) %>%
      summarise(hypertension_count = sum (hyperten == 1, na.rm = TRUE))
    
    ggplot(pie_data, aes( x = "", y = hypertension_count, fill = age_group)) +
      geom_col(width = 1) +
      coord_polar(theta = "y") +
      labs(title = "Hypertension cases by Age Group", fill = "Age Group") +
      theme_void()
  })
  
  output$pie_summary <- renderTable({
    
    dig_mut1 %>%
      group_by(age_group) %>%
      summarise(
        total = n(),
        hypertension_cases = sum(hyperten == 1, na.rm = TRUE),
        hypertension_percent = round(hypertension_cases/ total *100,1)
      )
  }) 
  
}


shinyApp(ui, server)

```
 Interpretation:
 
  I took that mutated data frame ("dig_mut1") as my dataset because I added a column for better age visualization  and I built a code for Age vs Hypertension(history of hypertension) and code is similar to my last code (age vs diabetes) .In this code i added an extra column in summary table (percent of hypertension cases from the age groups), the code will show that pie chart of age vs hypertension and a summary table with data of the pie chart..
 
Age vs Race
```{r}
#Comparison of Age with Race
library(shiny)
library(shinydashboard)
library(ggplot2)
library(readr)
library(dplyr)
library(janitor)

#Gathering the data
dig <- read.csv("DIG.csv")%>%
  clean_names()

ui<- dashboardPage(
  dashboardHeader(title = "DIG: Age vs Race"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Age vs Race", tabName ="Age_and_Race", icon= icon("users")))),
  dashboardBody(
    tabItems(
      tabItem(
        tabName= "Age_and_Race",
        fluidRow(
          box(
            width=6,
            title= "Age distribution by Race data",
            status= "primary",
          plotOutput("age_vs_race_plot")),
          box(
            width=6,
            title = "Summarising age by race data",
            status="info",
          tableOutput("summarising_age_vs_race")
          )
          )
        )
      )
    )
  )

server<- function(input, output, session) {
  
  #plotting a histogram to visualise the data
  output$age_vs_race_plot <- renderPlot({
    ggplot(dig, aes(x= age, fill = factor(race)))+
      geom_histogram(
        bins= 30,
        position = "identity",
        alpha= 0.8
      )+
      labs(
        x= "Age(years)",
        y= "Number of patients",
        fill= "Race",
        title = "Distribution of age by race")+
      theme_minimal()
  })
  
#summarising the age table by race
  output$summarising_age_vs_race <- renderTable({
    dig %>%
      group_by(race) %>%
      summarise(
        n = n(),
        mean_age = round(mean(age, na.rm = TRUE),1),
        median= median(age, na.rm = TRUE),
        min_age = min(age, na.rm = TRUE),
        max_age = max(age, na.rm = TRUE),
        .groups = "drop"
      )
  })
}

shinyApp(ui=ui,server = server)
```
Interpretation:
In this analysis, I used the DIG dataset where the age distributions are quite higher and similar to the race groups.
From both the race categories, the mean ages has been lying in the mid 60s with similar median and ranges, which is suggesting that all the patients from the different racial group enrolled in the study at a age that was comparable between each other.Although there are many patients in Race 1 than in Race group 2, the appearance of the histograms and the summary statistics had no major age imbalance between the races.

Comparing BMI and Race of the DIG dataset
```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(readr)
library(dplyr)
library(janitor)

#Cleaning the dataset 
dig<- read.csv("DIG.csv") %>%
  clean_names()

ui <- dashboardPage(
  dashboardHeader(title=" DIG:BMI and Race"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("BMI vs Race",
               tabName = "bmi_race",
               icon= icon("user"))
    )
  ),
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "bmi_race",
        fluidRow(
          box(
            width=6,
            status = "primary",
            title= "Summary of BMI by race",
            plotOutput("bmi_race_box")),
          box(width = 6, status="info", title = "Summary of BMI by race",
              tableOutput("bmi_race_summary")
          )
        )
      )
    )
  )
)

server <- function(input, output,session) {
  
  #plotting a boxplot to visualise the data for each race group
  output$bmi_race_box <-renderPlot({
    ggplot(dig,aes(x=factor(race),y= bmi,fill=factor(race)))+
      geom_boxplot(alpha=0.7, outlier.alpha = 0.6)+
      labs(
        x="Race",
        y="BMI",
        fill="Race",
        title = "Distribution of BMI by race"
      )+
      theme_minimal()
  })
  
  #summarising in a table
  output$bmi_race_summary <- renderTable ({
    dig %>%
      group_by(race) %>%
      summarise(
        n=n(),
        mean_bmi = round(mean(bmi, na.rm= TRUE),1),
        median= median(bmi,na.rm = TRUE),
        min_bmi= min(bmi, na.rm = TRUE),
        max_bmi= max(bmi, na.rm=TRUE),
        .groups= "drop"
      )
  })
}

shinyApp(ui=ui,server= server)
```
Interpretation:
With a similar code for the age vs race, I included a boxplot for the visualisation of bmi vs race. From the analysis done above, the BMI is very similar across both the racial groups of the trail, Both the groups have mean BMIs around 27 and almost similar medians, while the boxplot shows overlapping inter-quartile ranges and overall spread. Group 1 has many more patients than group 2 but their BMI distributions are shaped similar, with a same minimum and maximum values.Overall, there is no clear evidence of major difference in the BMI between the two racial categories in the dataset.

```{r}
names(dig)
```


Next Question:

ID vs NHOSP(number of hospitalisation):

```{r}

library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)


ui <- dashboardPage(
  dashboardHeader(title = "ID vs NHOSP"),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem("ID and Hospitalisation", tabName = "id_hosp", icon = icon("hospital"))
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "id_hosp",
        
        fluidRow(
          box(
            width = 6, status = "primary", solidHeader = TRUE,
            title = "Histogram : Number of Hospitalisations",
            plotOutput("hosp_hist")
          ),
          
          box(
            width = 6 , status = "info", solidHeader = TRUE,
            title = "Summary of NHOSP",
            tableOutput("hosp_summary")
          )
        )
      )
    )
  )
  
 )




server <- function (input, output, session) {
  
  output$hosp_hist <- renderPlot({
    ggplot(dig, aes(x= nhosp)) +
      geom_histogram(fill = "red", color = "grey",bins = 20, alpha = 0.7)+
      labs(
        title = "Distribution of Number of hospitalisations",
        x = "NSHOP(Number of Hospitalisations)",
        y = "count of patients"
      ) +
      theme_minimal()
    
  })
  
  output$hosp_summary <- renderTable({
    dig %>%
      summarise(
        total_patients = n(),
        mean_hosp = round(mean(nhosp, na.rm = TRUE),1 ),
        median_hosp = median(nhosp, na.rm = TRUE),
        min_hosp = min(nhosp, na.rm = TRUE),
        max_hosp = max(nhosp,na.rm = TRUE)
      )
  })
  
  
}

shinyApp(ui,server)

```
Interpretation:

I took datas of ID and NHOSP(number of hospitalization) and I made a shiny dash board code and it represents the patient id and number of hospitalizations and this code  will show the histogram of ID and NHOSP and i added the summary table of this data . It will show the  total patients, (mean,median,max,min)of hospitalizations .



Next question:

HEARTRTE(heart rate) vs CREV(coronary Revascularization):

```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)

ui <- dashboardPage(
  dashboardHeader(title = "Heart Rate vs coronary Revascularization"),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem("HEARTRTE VS CREV", tabName = "hr_crev", icon = icon("heartbeat"))
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "hr_crev",
        
        fluidRow(
          box(
            width = 6, status = "primary", solidHeader = TRUE,
            title = "Boxplot : Heart Rate by CREV status",
            plotOutput("hr_crev_plot")
          ),
          
          box(
            width = 6, status = "info", solidHeader = TRUE,
            title = "Summary Table",
            tableOutput("hr_crev_summary")
          )
        )
      )
    )
  )

)

server <- function(input, output, session){
  
  output$hr_crev_plot <- renderPlot({
    ggplot(dig, aes(x = as.factor(crev), y = heartrte, fill = as.factor(crev))) +
      geom_boxplot(alpha = 0.7) +
      labs(
        x = "CREV Status(0= no, 1 = yes )",
        y = "Heart rate(beats/min)",
        fill = "CREV",
        title = "Heart Rate Distribution by Coronary Revascularization"
      ) +
      theme_minimal()
  })
  
  output$hr_crev_summary <- renderTable({
    dig%>%
      group_by(crev) %>%
      summarise(
        count = n(),
        mean_hr = round(mean(heartrte, na.rm = TRUE),1 ),
        median_hr = median(heartrte, na.rm = TRUE),
        min_hr = min(heartrte, na.rm = TRUE),
        max_hr = max(heartrte, na.rm = TRUE)
      )
  })
 
}


shinyApp(ui,server)

```
Interpretation:

I took the data of Heart rate (HEARTRTE) and coronary revascularization (CREV) as my data. and I build a shiny dashboard code for this two data and I made a boxplot of representing each HEARTRTE and CREV  and i also added the  summary table mentioning the count, crev, mean, median, max, min of the data to visualize the data clearly..so this code will show the crev status (yes =1 ,no =0) and heart rate (beats/min) in a boxplot and a summary table of the data

Proportion of Treatment vs Death
```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)
library(scales)

#Cleaning the dataset 
dig<- read.csv("DIG.csv") %>%
  clean_names()

ui <- dashboardPage(
  dashboardHeader(title = "DIG:Treatment vs Death"),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem("Treatment vs Death", tabName = "trt_death", icon = icon("heart-pulse"))
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "trt_death",
        
        fluidRow(
          box(
            width = 6, status = "primary",
            title = "Death Rate by Treatment",
            plotOutput("trt_death_bar")
          ),
          
          box(
            width = 6, status = "info",
            title = "Summary: death by treatment",
            tableOutput("trt_death_summary")
          )
        )
      )
    )
  )

)

server <- function(input, output, session){
  
  output$trt_death_bar <- renderPlot({
    sum_data <- dig %>%
      group_by(trtmt) %>%
      summarise(
        n=n(),
        deaths= sum(death == 1, na.rm = TRUE),
        death_rt= deaths/n,
        .groups="drop"
      )
print(sum_data)
      #adding a plot for easy visualisation
ggplot(data=sum_data,
       mapping=aes(x=factor(trtmt),
                   y=death_rt,
                   fill = factor(trtmt)))+
      geom_col() +
      ylim(0,0.5)+
      labs(
        x="Treatment group",
        y="Death rate",
        fill= "Treatment",
        title= "Proportion of deaths by treatment"
      )+
      theme_minimal()
  })
#summarising the data in a table
  output$trt_death_summary <- renderTable({
    dig %>%
      group_by(trtmt) %>%
      summarise(
        n=n(),
        deaths= sum(death==1, na.rm=TRUE),
        death_rt = round(100* deaths/n,1),
        .groups = "drop"
      )
  })
}

shinyApp(ui=ui, server= server)

```
Interpretation:
Firstly I have cleaned the dataset and then grouped it by treatment (trtmt= 0 vs 1). For each of this group , calculated the number of patients, number of deaths and the death rate. Plotting this death rates as a bar chart for easy comparison of the results of the trail.The results show very similar death rate in both the groups ~35% siggestive of no large mortality difference between the treatment groups in the dataset.

Creating a shinydashboard
```{r}
library(shiny)
library(shinydashboard)

#adding a dashboard to the app
ui <- dashboardPage(
  dashboardHeader(title = "DIG dashboard"),
  dashboardSidebar(
    sidebarMenu(                #trying to make one using any 2 comparative analysis
      menuItem("Age vs Race",       tabName = "age_race",icon=icon("users")),
      menuItem("Treatment vs Death", tabName = "trt_death",icon = icon("heart-pulse"))
    )
  ),
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "age_race",
        h2("Age vs Race page")
      ),
      tabItem(
        tabName = "trt_death",
        h2("Treatment vs Death page")
      )
    )
  )
)

server <- function(input, output, session) {
  
}

shinyApp(ui=ui ,server=server)
```
Comment:
I created a simple Shiny dashboard layout with a header, a sidebar menu and two of the empty content tabs that can be filled. I have used the server function which is currently empty, so no outputs are generated so far, it simply connects the UI and allows the app to run without errors.

Comparison of BMI with Diabetes Mellitus(DM)
```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)

#Loading the data
dig <- read.csv("DIG.csv") %>%
  clean_names()

ui<- dashboardPage(
  dashboardHeader(title= "DIG:BMI vs Diabetes Mellitus"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("BMI vs Diabetes",
               tabName = "bmi_diab",
               icon= icon("stethoscope"))
    )
  ),
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "bmi_diab",
        fluidRow(
          box(
            widtg=6, status = "primary",
            title= "BMI by Diabetes status",
            plotOutput("bmi_diab_plot")
          ),
          box(
            width=6, status = "info",
            title = "Summary: BMI by diabetes status",
            tableOutput("bmi_diab_summary")
          )
        )
      )
    )
  )
)

server <- function(input, output,session){
  
  #creating a distributuion plot of BMI by diabetes
  output$bmi_diab_plot <- renderPlot({
    ggplot(
      data=dig,
      mapping = aes(x=factor(diabetes),y=bmi,fill=factor(diabetes))
    )+
      geom_violin(trim = FALSE, alpha=0.7)+
      geom_jitter(width = 0.1, alpha=0.15, size= 0.8)+
      labs(
        x="Diabetes(0=no, 1=yes)",
        y="BMI",
        fill="Diabetes",
        title = "BMI distribution by diabetes status"
      )+
      theme_minimal()
  })
  
  #summarising the table of BMI comparsion with diabetes
  output$bmi_diab_summary <- renderTable({
    dig %>%
      group_by(diabetes) %>%
      summarise(
        n=n(),
        mean_bmi=round(mean(bmi, na.rm=TRUE),1),
        median= median(bmi,na.rm = TRUE),
        min_bmi=min(bmi, na.rm=TRUE),
        max_bmi= max(bmi, na.rm = TRUE),
        .groups = "drop"
      )
  })
  
}

shinyApp(ui=ui,server=server)
```
Interpretation:
I have created a violin plot to visualise the comparison of BMI vs Diabetes by initially cleaning the data. After the analysis (summarised in the table), the mean BMI is almost the same in both the treatment groups and the median of both is also almost similar.
Most importantly the patients with or without diabetes have very similar BMI distributions, thus BMI does not differ mucb by the presence or absence of diabetes in the DIF trail dataset.

Comparing the treatment with related outcomes
```{r}
#loading the libraries
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)

#Loading of the data
dig <- read.csv("DIG.csv") %>%
  clean_names()

ui<- dashboardPage(
  dashboardHeader(title = "DIG Trail Treatment Comparisons"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Treatment vs Outcome",
               tabName = "trt_outcome",
               icon = icon("exchange-alt")))),
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "trt_outcome",
        fluidRow(
          box(
            width = 4, status = "warning",
            title = "Choose outcome",
            selectInput(
              inputId = "outcome_var",
              label = "Outcome variable:",
              choices = c("Worsening HF(whf)"="whf",
                          "Myocardial infarction(mi)"="mi",
                          "Stroke(strk)"="strk"
              ),
              selected="whf")),
          box(
            width = 8, status = "primary",
            title = "Event Occurence by Treatment",
            plotOutput("trt_outcome_plot"))),
        fluidRow(
          box(
            width = 12, status = "info",
            title= "Summary by treatment",
            tableOutput("trt_outcome_summary")
          )
        )
      )
    )
  )
)

server <- function(input, output, session) {
  #computing the counts for the desirable outcome wanted
  summary_data <- reactive({
    out<- sym(input$outcome_var)
    dig %>%
      group_by(trtmt)%>%
      summarise(
        n=n(),
        events= sum(!!out==1, na.rm = TRUE),
        rate= events/n,
        .groups = "drop"
      )
  })
  
  output$trt_outcome_plot <- renderPlot({
    df <- summary_data()
    ggplot(df,aes(x=factor(trtmt),y=rate,fill = factor(trtmt)))+
      geom_col()+
      ylim(0,0.6)+
      labs(
        x= "Treatment(0=placebo, 1=digoxin)",
        y= "Event rate(proportion)",
        fill="Treatment",
        title = paste("Event Rate by Treatment for",input$outcome_var)
      )+
      theme_classic()
  })
  
  output$trt_outcome_summary <- renderTable({
    summary_data() %>%
      mutate(rate_percent= round(100*rate,1))
  })
}

shinyApp(ui=ui,server=server)
```
Interpretation
According to the data visualisation the events of whf were more common in placebo than than the digoxin treatment group.
For MI; the event rates are quite low and much similar in both the groups
Lastly in case of stroke, the events were low and almost equal in both the groups.



Next Question:

Comparing all the Treatment group of Age,Sex,Race :

```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(readr)
library(janitor)
library(dplyr)


dig <- read.csv("DIG.csv")%>%
  clean_names()

ui <- dashboardPage(
  dashboardHeader(title = "Treatment group comparisions"),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem("Treatment comparisions",
               tabName = "treat_compare",
               icon = icon("chart-bar"))
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "treat_compare",
        
        fluidRow(
          
          box(width = 4, status = "primary", solidHeader = TRUE,
              title = "Age vs Treatment",
              plotOutput("age_treat_plot")),
          
          box(width = 4 , status = "success", solidHeader = TRUE,
              title = "Sex vs Treatment",
              plotOutput("sex_treat_plot")),
          
          box(width = 4, status = "info", solidHeader = TRUE,
              title = "Race vs Treatment",
              plotOutput("race_treat_plot"))
          
        )
      )
    )
  )
  
)


server <- function(input, output, session){
  
  output$age_treat_plot <- renderPlot({
    ggplot(dig,aes(x = factor(trtmt), y = age, fill = factor(trtmt))) +
      geom_boxplot() +
      labs(
        title = "Age Distribution by Treatment",
        x = "Treatment (0 = Placebo, 1 = Digoxin)",
        y = "age"
      ) +
      theme_minimal()
  })
  
  output$sex_treat_plot <- renderPlot({
    dig %>% 
      count(trtmt, sex) %>%
      ggplot(aes(x = factor(trtmt), y = n, fill = factor(sex))) +
      geom_bar(stat = "identity", position = "dodge") +
      labs(
        title = "Sex Distribution by Treatment",
        x = "Treatment",
        y = "count",
        fill = "Sex(1 = Male, 2 = Female)"
      )+
      theme_minimal()
  })
  
  
  
  output$race_treat_plot <- renderPlot({
    dig %>%
      count(trtmt, race) %>%
      ggplot(aes(x = factor(trtmt), y= n, fill = factor(race))) +
      geom_bar(stat = "identity", position =  "dodge") +
      labs(
        title = "Race Distribution by Treatment",
        x = "Treatment",
        y = "Count",
        fill = "Race(1 = White, 2 = Non-white)"
      ) +
      theme_minimal()
  })
  
  
  
}

shinyApp(ui, server)

```
Interpretation:
 I made a shiny dashboard code representing the Treatment group vs Age,Sex,Race and it made an error at first because of column names and i cleared the error and this code will show Age vs Treatment in boxplot and sex vs treatment code and race vs treatment code in bar graphs.I differed the treatment vs age as [1= Placebo,0= Digoxin], and treatment vs sex as[1- Male, 2-Female] and race as [1-White ,2- Non -white] .. I didnt use summary table for this code because the graph mentions the data clearly. i combined three data from previous code and made combined them to see the code is working properly..

```{r}
names(dig)
```

Comparing the digoxin treatment with other continuous parameters
```{r}
#loading the different libraries
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)

#cleaning of the data
dig <- read.csv("DIG.csv") %>%
  clean_names()

#creating the dashboard
ui <- dashboardPage(
  dashboardHeader(title = "DIG Treatment & continous measures"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Treatment vs parameter",
               tabName = "trt_parameter",
               icon=icon("sliders")))),
  dashboardBody(
    tabItems(tabItem(
      tabName = "trt_parameter",
      fluidRow(
        box(
          width = 4, status = "warning",
          title = "Choose parameter",
          selectInput(
            inputId = "cont_var",
            label = "Continuous variable:",
            choices = c("Ejection fraction(%)"= "ejf_per",
                        "Systolic BP(mmHG)"="sysbp",
                        "Creatinine(mg/dL)"="creat"),
            selected = "ejf_per")),
        box(width=8, status = "primary",
            title = "Distribution by treatment",
            plotOutput("trt_parameter_plot"))
      ),
      fluidRow(
        box(
          width = 12,status = "info",
          title = "Summary by treatment",
          tableOutput("trt_parameter_summary")
        )
      )
    ))
  )
)

server <- function(input,output,session) {
  #creating labels for the titles
  pretty_label <- reactive({
    switch (
      input$cont_var,
      ejf_per = "Ejection fraction (%) ",
      sysbp = "Systolic blood pressure(mmHG) ",
      creat= "Serum creatinine "
    )
  })
  
  #making a reactive data with those selected variable 
  parameter_data <- reactive({
    dig %>%
      select(trtmt, !!sym(input$cont_var)) %>%
      rename(value=!!sym(input$cont_var)) %>%
      filter(!is.na(value))
  })
  
  output$trt_parameter_plot <- renderPlot({
    df<- parameter_data()
    ggplot(df, aes(x=value, fill = factor(trtmt)))+
      geom_density(alpha=0.4, colour= NA)+
      facet_wrap(~trtmt, nrow=2, labeller= label_both)+
      scale_fill_manual(values = c("pink","red"),
                        name= "Treatment",
                        labels=c("0=placebo","1=digoxin"))+
      labs(
        x=pretty_label(),
        y="Density",
        title = paste0(pretty_label(), "by treatment"))+
      theme_minimal(base_size=13)
  })

output$trt_parameter_summary <- renderTable({
  parameter_data() %>%
    group_by(trtmt) %>%
    summarise(
      n=n(),
      mean= round(mean(value, na.rm=TRUE),1),
      median= round(median(value, na.rm = TRUE),1),
      sd = round(sd(value, na.rm=TRUE),1),
      min= round(min(value, na.rm = TRUE),1),
      max =round(max(value,na.rm = TRUE),1),
      .groups = "drop"
    )
})
}

shinyApp(ui = ui, server = server)
```
Interpretation:
The analysis shows that the primary baselines continuous variable that is the SBP, Ejection fraction and creatinine have similar kind of distributions on the plot and the average in both placebo and digoxin group is same too.This indicates that the placebo and digoxin treatment groups were well balanced for these parameters at the baseline itself.
For doing the above a built a shiny dashboard tab where the user can choose a variable of choice and see the distribution by treatment as a density plot along with a summary table using summary statistics. I have also included a reactive expression to select and rename the variable of choice, then the libraries like ggplot2 and dplyr were used to draw the faceted densities and compute the group-wise summary statistics.

Next question:


WHF(worsening heart failure) vs Diastolic BP, Systolic BP, Heart Rate..

```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)



dig <- read.csv("DIG.csv") %>%
  janitor::clean_names()




ui <- dashboardPage(
  dashboardHeader(title = "WHF vs Clinical parameters"),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem("WHF Comparisions",
               tabName = "whf_compare",
               icon = icon("heartbeat"))
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "whf_compare",
        
        fluidRow(
          box(width = 4, status = "primary", solidHeader = TRUE,
              title = "WHF vs Heart Rate",
              plotOutput("whf_hr_plot")),
          
          box(width = 4, status = "success", solidHeader = TRUE,
              title = "WHF vs Diastolic BP ",
              plotOutput("whf_diabp_plot")),
          
          box(width = 4, status = "info", solidHeader = TRUE,
              title = "WHF vs Systolic BP",
              plotOutput("whf_sysbp_plot"))
          
          
          
        ),
        
        fluidRow(
          box(width = 12, status = "warning", solidHeader = TRUE,
              title = "summary Table (WHF vs Parameters)",
              tableOutput("whf_summary"))
        )
        
        
        
        
        
      )
    )
  )
)

server <- function(input, output, session) {
  
  output$whf_hr_plot <- renderPlot({
    ggplot(dig, aes(x = factor(whf) , y = heartrte , fill = factor(whf))) +
      geom_boxplot(alpha = 0.8) +
      labs(
        title = "Heart Rate by WHF Status",
        x = "WHF( 0 = No, 1 = Yes)",
        y = "Heart Rate (beats/min)",
        fill = "WHF"
      )+
      theme_minimal()
      
      
  })
  
  output$whf_diabp_plot <- renderPlot({
    ggplot(dig,aes(x = factor(whf), y = diabp, fill = factor(whf)))+
      geom_boxplot(alpha = 0.8) +
      labs(
        title = "Diastolic Blood Pressure by WHF Status",
        x = "WHF (0 = No , 1 = Yes)",
        y = "Diastolic Bp(mmHg)",
        fill = "WHF"
      )+
      theme_minimal()
  })
  
  
  output$whf_sysbp_plot <- renderPlot({
    ggplot(dig, aes(x = factor(whf),y = sysbp, fill = factor(whf))) +
      geom_boxplot(alpha  = 0.8) +
      labs(
        title = "Systolic Blood Pressure by WHF Status",
        x = "WHF (0= No, 1 = Yes)",
        y = "Systolic BP(mmHg)",
        fill = "WHF"
      )+
      theme_minimal()
  })
  
  
  output$whf_summary <- renderTable({
    dig%>%
      group_by(whf) %>%
      summarise(
        n = n(),
        mean_heartrte = round(mean(heartrte, na.rm = TRUE),1),
        mean_diabp = round(mean(diabp, na.rm = TRUE),1),
        mean_sysbp = round(mean(sysbp, na.rm = TRUE),1),
        
        
        
        median_heartrte = median(heartrte, na.rm = TRUE),
        median_diabp =median(diabp, na.rm = TRUE),
        median_sysbp = median(sysbp, na.rm = TRUE),
        
        
        min_heartrte = min(heartrte, na.rm = TRUE),
        max_heartrte = max(heartrte, na.rm = TRUE),
        
        min_diabp = min(diabp, na.rm = TRUE),
        max_diabp = max(diabp, na.rm = TRUE),
        
        min_sysbp = min(sysbp, na.rm = TRUE),
        max_sysbp = max(sysbp, na.rm = TRUE)
      )
  })
  
  
}


shinyApp(ui,server)
```


